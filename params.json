{"name":"Kohana + CL4 + XM Site Template","tagline":"Template for Kohana + CL4 + XM Kohana Module","body":"# Kohana + cl4 + XM Template\r\n\r\nThis template includes everything needed to quickly get started using the [cl4](http://cl4.claero.com) and [XM](https://github.com/xmmedia/kohana_module) modules with Kohana. Right now it's setup to use Kohana 3.3.0.\r\n\r\n## Setting Up a Site Using the XM Template\r\n\r\nThe XM Template can be found here: https://github.com/xmmedia/xm_template\r\n\r\nThe basic idea is to pull down the code, as a ZIP or TAR either from github or from a cloned repo on your machine. Extract the ZIP/TAR to your working directory, add submodules and Kohana, and then start configuring the site. Typically, using the template, I get a site up and running in 15 minutes. Note these instructions have some specifics for XM Media, InterWorx, and Beanstalk, so tweak as necessary for your own setup.\r\n\r\n1. Setup the repo in Beanstalk (can be done with Tower Git)\r\n2. Clone the repo locally\r\n3. Export the cl4template repo into the local repo\r\n   * Remove all the module folders inside modules\r\n   * Remove the system dir\r\n   * Remove html/cl4 & html/xm\r\n4. Commit everything and push into Beanstalk. You'll need to create the master branch on Beanstalk when doing the first push.\r\n5. Add submodules and checkout the correction versions. Then commit.  Run each piece of code (of the first script) after each comment separately as it will break otherwise. Or create a base script to the run the commands (especially useful if doing this more than once).\r\n6. Add site on InterWorx or other server software.\r\n7. Setup in Sublime or other editor and Transmit or other FTP/SFTP client.\r\n8. Upload the files\r\n9. Change the user in reset_permissions.sh (and any other necessary changes) and then run it\r\n10. Create database in InterWorx (on server)\r\n11. Change the database collation to utf8_unicode_ci\r\n12. Import SQL from create_mysql.sql and optimize all the tables\r\n13. Put database config in `application/config/database.php` and change the change script database in `application/config/change_script.php`\r\n14. Update application/init.php\r\n    * change long and short name\r\n    * set url root\r\n    * set abs root\r\n    * remove default analytics ID for dev\r\n    * update the recaptcha keys (xmmedia keys are 6Lcx3r8SAAAAABYYRNe-jm5fuZcJnkRsdR1RLZjd and 6Lcx3r8SAAAAAKa_TPZKcuQV7NoI_M5pT8Culdj8)\r\n    * change admin email address (2)\r\n15. Login and update the admin user info. At the same time you're doing this, update the auth salt. So, (1) login, (2) click edit on the admin user, (3) enter the new information and don't save. (4) Change the auth salt (https://www.grc.com/passwords.htm|great place to get salts) and upload to the server. (5) Then save the user.\r\n    * change username from admin@admin.com to the correct admin username\r\n    * change the password (current 123456)\r\n    * change name to XM Media\r\n    * If you change the auth salt later, you'll need to retrieve your salted password like: ''echo debug::vars(auth::instance()->hash('<password>'));''\r\n16. Update cl4mail config\r\n    * change from address and name\r\n    * add mandrill api key & username\r\n17. Add the admin username choosen in step 15 to the array of admin accounts in config/cl4login\r\n18. Change the cookie (bootstrap) salt\r\n19. Update robots.txt sitemap path and remove comment\r\n20. Change the necessary information on the ''config/model_create''\r\n\r\n### Submodule Scripts\r\n\r\nAdd the submodules:\r\n```bash\r\n#!/bin/bash\r\n# add submodules\r\n# run this from within the root of your repo\r\ngit submodule add git://github.com/kohana/core.git system\r\ngit submodule add git://github.com/kohana/auth.git modules/auth\r\ngit submodule add git://github.com/kohana/cache.git modules/cache\r\ngit submodule add git://github.com/kohana/codebench.git modules/codebench\r\ngit submodule add git://github.com/kohana/database.git modules/database\r\ngit submodule add git://github.com/kohana/image.git modules/image\r\ngit submodule add git://github.com/kohana/minion.git modules/minion\r\ngit submodule add git://github.com/kohana/orm.git modules/orm\r\ngit submodule add git://github.com/kohana/unittest.git modules/unittest\r\ngit submodule add git://github.com/kohana/userguide.git modules/userguide\r\ngit submodule init\r\n# add claero modules\r\ngit submodule add git@github.com:claerosystems/cl4.git modules/cl4\r\ngit submodule add git@github.com:claerosystems/cl4base.git modules/cl4base\r\ngit submodule add git@github.com:claerosystems/cl4docroot.git html/cl4\r\ngit submodule init\r\n# add xmmedia modules\r\ngit submodule add git@github.com:xmmedia/kohana_module.git modules/xm\r\ngit submodule add git@github.com:xmmedia/kohana_module_docroot.git html/xm\r\ngit submodule init\r\n```\r\n\r\nCheckout the correct versions of the modules:\r\n```bash\r\n#!/bin/bash\r\n# checkout the correct versions of the module (currently v3.3.0 for most Kohana modules and kohana_v3.3/master for cl4 & xm)\r\necho \"-- submodule init & update\" &&\r\ngit submodule init && git submodule update &&\r\necho \"-- module > Kohana Auth\" &&\r\ncd modules/auth && git checkout 3.1/master && git pull && git checkout v3.3.0 &&\r\necho \"-- module > Kohana Cache\" &&\r\ncd ../cache && git checkout 3.1/master && git pull && git checkout v3.3.0 &&\r\necho \"-- module > Kohana Codebench\" &&\r\ncd ../codebench && git checkout 3.1/master && git pull && git checkout v3.3.0 &&\r\necho \"-- module > Kohana Database\" &&\r\ncd ../database && git checkout 3.1/master && git pull && git checkout v3.3.0 &&\r\necho \"-- module > Kohana Image\" &&\r\ncd ../image && git checkout 3.1/master && git pull && git checkout v3.3.0 &&\r\necho \"-- module > Kohana Minion\" &&\r\ncd ../minion && git checkout 3.3/master && git pull && git checkout v3.3.0 &&\r\necho \"-- module > Kohana ORM\" &&\r\ncd ../orm && git checkout 3.1/master && git pull && git checkout v3.3.0 &&\r\necho \"-- module > Kohana Unit Test\" &&\r\ncd ../unittest && git checkout 3.1/master && git pull && git checkout v3.3.0 &&\r\necho \"-- module > Kohana Userguide\" &&\r\ncd ../userguide && git checkout 3.1/master && git pull && git checkout v3.3.0 &&\r\necho \"-- module > cl4\" &&\r\ncd ../cl4 && git checkout master && git pull && git checkout kohana_v3.3/master &&\r\necho \"-- module > cl4base\" &&\r\ncd ../cl4base && git checkout master && git pull && git checkout kohana_v3.3/master &&\r\necho \"-- module > cl4docroot\" &&\r\ncd ../../html/cl4 && git checkout master && git pull && git checkout kohana_v3.3/master &&\r\necho \"-- module > Kohana System\" &&\r\ncd ../../system && git checkout 3.1/master && git pull && git checkout v3.3.0 &&\r\ncd .. &&\r\necho \"-- module > XM\" &&\r\ncd modules/xm && git checkout master && git pull && git checkout kohana_v3.3/master &&\r\necho \"-- module > XM Docroot\" &&\r\ncd ../../html/xm && git checkout master && git pull && git checkout kohana_v3.3/master &&\r\ncd ../..\r\n```","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}