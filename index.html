<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Kohana + CL4 + XM Site Template by xmmedia</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>Kohana + CL4 + XM Site Template</h1>
        <p>Template for Kohana + CL4 + XM Kohana Module</p>

        <p class="view"><a href="https://github.com/xmmedia/xm_template">View the Project on GitHub <small>xmmedia/xm_template</small></a></p>


        <ul>
          <li><a href="https://github.com/xmmedia/xm_template/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/xmmedia/xm_template/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/xmmedia/xm_template">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h1>Kohana + cl4 + XM Template</h1>

<p>This template includes everything needed to quickly get started using the <a href="http://cl4.claero.com">cl4</a> and <a href="https://github.com/xmmedia/kohana_module">XM</a> modules with Kohana. Right now it's setup to use Kohana 3.3.0.</p>

<h2>Setting Up a Site Using the XM Template</h2>

<p>The basic idea is to pull down the code, as a ZIP or TAR either from github or from a cloned repo on your machine. Extract the ZIP/TAR to your working directory, add submodules and Kohana, and then start configuring the site. Typically, using the template, I get a site up and running in 15 minutes. Note these instructions have some specifics for XM Media, InterWorx, and Beanstalk, so tweak as necessary for your own setup.</p>

<ol>
<li>Setup the repo in Beanstalk (can be done with Tower Git)</li>
<li>Clone the repo locally</li>
<li>Export the cl4template repo into the local repo

<ul>
<li>Remove all the module folders inside modules</li>
<li>Remove the system dir</li>
<li>Remove html/cl4 &amp; html/xm</li>
</ul>
</li>
<li>Commit everything and push into Beanstalk. You'll need to create the master branch on Beanstalk when doing the first push.</li>
<li>Add submodules and checkout the correction versions. Then commit. 2 scripts below these instructions will make it much easier. Run each section of code after each comment separately as it will break otherwise. Or create a base script to the run the commands (especially useful if doing this more than once).</li>
<li>Add site on InterWorx or other server software.</li>
<li>Setup in Sublime or other editor and Transmit or other FTP/SFTP client.</li>
<li>Upload the files</li>
<li>Change the user in reset_permissions.sh (and any other necessary changes) and then run it</li>
<li>Create database in InterWorx (on server)</li>
<li>Change the database collation to utf8_unicode_ci</li>
<li>Import SQL from <code>sql/create_mysql.sql</code> and optimize all the tables</li>
<li>Put database config in <code>application/config/database.php</code> and change the change script database in <code>application/config/change_script.php</code>
</li>
<li>Update application/init.php

<ul>
<li>change long and short name</li>
<li>set url root</li>
<li>set abs root</li>
<li>remove default analytics ID for dev</li>
<li>update the recaptcha keys</li>
<li>change admin email address (twice)</li>
</ul>
</li>
<li>Login and update the admin user info. At the same time you're doing this, update the auth salt. So, (1) login, (2) click edit on the admin user, (3) enter the new information and don't save. (4) Change the auth salt (<a href="https://www.grc.com/passwords.htm">GRC</a> is a great place to get salts) and upload to the server. (5) Then save the user.

<ul>
<li>change username from <a href="mailto:admin@admin.com">admin@admin.com</a> to the correct admin username</li>
<li>change the password (current 123456)</li>
<li>change name to the company name (ie, XM Media)</li>
<li>If you change the auth salt later, you'll need to retrieve your salted password like: <code>echo debug::vars(auth::instance()-&gt;hash('&lt;password&gt;'));</code>
</li>
</ul>
</li>
<li>Update cl4mail config

<ul>
<li>change from address and name</li>
<li>add <a href="http://mandrill.com/">Mandrill</a> api key &amp; username</li>
</ul>
</li>
<li>Add the admin username choosen in step 15 to the array of admin accounts in <code>config/cl4login</code>
</li>
<li>Change the cookie salt (in bootstrap)</li>
<li>Update robots.txt sitemap path and remove comment</li>
<li>Change the necessary information on the <code>config/model_create</code>
</li>
</ol><h3>Submodule Scripts</h3>

<p>Add the submodules:</p>

<div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># add submodules</span>
<span class="c"># run this from within the root of your repo</span>
git submodule add git://github.com/kohana/core.git system
git submodule add git://github.com/kohana/auth.git modules/auth
git submodule add git://github.com/kohana/cache.git modules/cache
git submodule add git://github.com/kohana/codebench.git modules/codebench
git submodule add git://github.com/kohana/database.git modules/database
git submodule add git://github.com/kohana/image.git modules/image
git submodule add git://github.com/kohana/minion.git modules/minion
git submodule add git://github.com/kohana/orm.git modules/orm
git submodule add git://github.com/kohana/unittest.git modules/unittest
git submodule add git://github.com/kohana/userguide.git modules/userguide
git submodule init
<span class="c"># add claero modules</span>
git submodule add git@github.com:claerosystems/cl4.git modules/cl4
git submodule add git@github.com:claerosystems/cl4base.git modules/cl4base
git submodule add git@github.com:claerosystems/cl4docroot.git html/cl4
git submodule init
<span class="c"># add xmmedia modules</span>
git submodule add git@github.com:xmmedia/kohana_module.git modules/xm
git submodule add git@github.com:xmmedia/kohana_module_docroot.git html/xm
git submodule init
</pre></div>

<p>Checkout the correct versions of the modules:</p>

<div class="highlight"><pre><span class="c">#!/bin/bash</span>
<span class="c"># checkout the correct versions of the module (currently v3.3.0 for most Kohana modules and kohana_v3.3/master for cl4 &amp; xm)</span>
<span class="nb">echo</span> <span class="s2">"-- submodule init &amp; update"</span> <span class="o">&amp;&amp;</span>
git submodule init <span class="o">&amp;&amp;</span> git submodule update <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; Kohana Auth"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd </span>modules/auth <span class="o">&amp;&amp;</span> git checkout 3.1/master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout v3.3.0 <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; Kohana Cache"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../cache <span class="o">&amp;&amp;</span> git checkout 3.1/master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout v3.3.0 <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; Kohana Codebench"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../codebench <span class="o">&amp;&amp;</span> git checkout 3.1/master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout v3.3.0 <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; Kohana Database"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../database <span class="o">&amp;&amp;</span> git checkout 3.1/master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout v3.3.0 <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; Kohana Image"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../image <span class="o">&amp;&amp;</span> git checkout 3.1/master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout v3.3.0 <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; Kohana Minion"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../minion <span class="o">&amp;&amp;</span> git checkout 3.3/master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout v3.3.0 <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; Kohana ORM"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../orm <span class="o">&amp;&amp;</span> git checkout 3.1/master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout v3.3.0 <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; Kohana Unit Test"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../unittest <span class="o">&amp;&amp;</span> git checkout 3.1/master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout v3.3.0 <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; Kohana Userguide"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../userguide <span class="o">&amp;&amp;</span> git checkout 3.1/master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout v3.3.0 <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; cl4"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../cl4 <span class="o">&amp;&amp;</span> git checkout master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout kohana_v3.3/master <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; cl4base"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../cl4base <span class="o">&amp;&amp;</span> git checkout master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout kohana_v3.3/master <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; cl4docroot"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../../html/cl4 <span class="o">&amp;&amp;</span> git checkout master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout kohana_v3.3/master <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; Kohana System"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../../system <span class="o">&amp;&amp;</span> git checkout 3.1/master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout v3.3.0 <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> .. <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; XM"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd </span>modules/xm <span class="o">&amp;&amp;</span> git checkout master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout kohana_v3.3/master <span class="o">&amp;&amp;</span>
<span class="nb">echo</span> <span class="s2">"-- module &gt; XM Docroot"</span> <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../../html/xm <span class="o">&amp;&amp;</span> git checkout master <span class="o">&amp;&amp;</span> git pull <span class="o">&amp;&amp;</span> git checkout kohana_v3.3/master <span class="o">&amp;&amp;</span>
<span class="nb">cd</span> ../..
</pre></div>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/xmmedia">xmmedia</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
    
  </body>
</html>