(function($,c,b){function a(g,e){function f(i){$(d).each(function(){var j=$(this);this!==i.target&&!j.has(i.target).length&&j.triggerHandler(e,[i.target])})}e=e||g+b;var d=$(),h=g+"."+e+"-special-event";$.event.special[e]={setup:function(){d=d.add(this);d.length===1&&$(c).bind(h,f)},teardown:function(){d=d.not(this);d.length===0&&$(c).unbind(h)},add:function(i){var j=i.handler;i.handler=function(l,k){l.target=k;j.apply(this,arguments)}}}}$.map("click dblclick mousemove mousedown mouseup mouseover mouseout change select submit keydown keypress keyup".split(" "),function(d){a(d)});a("focusin","focus"+b);a("focusout","blur"+b);$.addOutsideEvent=a})(jQuery,document,"outside");var xm={};xm.multiple_edit_count=0;xm.button_link_form=function(){var button_form_action=$(this).data("xm_form_action"),form,form_target;if(button_form_action){form=$(this.form);form.attr("action",button_form_action);form_target=$(this).data("xm_form_target");form_target?form.attr("target",form_target):form.attr("target","")}};xm.button_link=function(){var link=$(this).data("xm_link");link&&(window.location=link)};xm.multiple_edit=function(){};xm.export_selected=function(){};xm.add_multiple_form=function(){var count_select=$(this),add_multiple_button=$("#"+count_select.data("xm_add_multiple_related_button")),add_multiple_form_action_prefix=add_multiple_button.data("xm_add_multiple_form_action_prefix");add_multiple_button.data("xm_form_action",add_multiple_form_action_prefix+"/"+count_select.val())};xm.multiple_edit_form=function(){$(".js_xm_multiple_edit_form_checkbox:checked").length>0?$(".js_xm_multiple_edit, .js_xm_export_selected").removeAttr("disabled"):$(".js_xm_multiple_edit, .js_xm_export_selected").attr("disabled","disabled")};xm.check_all_checkbox=function(){var checkbox=$(this);checkbox.filter(":checked").length>0?$("."+checkbox.data("xm_check_all_checkbox_class")).attr("checked","checked").change():$("."+checkbox.data("xm_check_all_checkbox_class")).removeAttr("checked").change()};xm.row_checked=function(){$(this).attr("checked")?$(this).parents("tr").addClass("selected"):$(this).parents("tr").removeClass("selected")};xm.model_select_change=function(){window.location="/dbadmin/"+$("#xm_model_select").val()+"/index"};typeof $.datepicker!="undefined"&&$.datepicker.setDefaults({dateFormat:"yy-mm-dd",buttonImage:"/xm/images/calendar.gif",buttonImageOnly:!0});$(function(){typeof $.datepicker!="undefined"&&$(".js_xm_date_field-date").datepicker();$(".js_xm_button_link_form").on("click",xm.button_link_form);$(".js_xm_button_link").on("click",xm.button_link);$(".js_xm_multiple_edit").on("click",xm.multiple_edit);$(".js_xm_export_selected").on("click",xm.export_selected);$(".js_xm_multiple_edit_form").on("change",xm.multiple_edit_form);$(".js_xm_check_all_checkbox").on("click",xm.check_all_checkbox);$(".xm_add_multiple_count").on("change",xm.add_multiple_form);$(".js_xm_row_checkbox").on("change",xm.row_checked);$(".js_xm_model_select_form").on("change",xm.model_select_change);$(".js_xm_model_select_go").on("click",xm.model_select_change)});xm.ajax_error_msgs={default_msg:"There was a error loading some of the content on this page.<br>Try reloading the page or contacting an administrator.",not_logged_in:'You are no longer logged in. <a href="/login">Click here to login.</a>',timed_out:'Your login has timed out. To continue using your current login, <a href="/login/timedout">click here to enter your password.</a>',not_allowed:"You do not have the necessary permissions to access some of the functionality on this page.",not_found_404:"The requested URL was not found."};xm.add_ajax_error=function(error){xm.add_message_div(error)};xm.add_ajax_validation_msg=function(return_data){xm.hide_ajax_validation_msgs();return_data!==null&&typeof return_data=="object"&&typeof return_data.validation_msg!="undefined"&&return_data.validation_msg!==""&&xm.add_message_div(return_data.validation_msg,"xm_ajax_validation_msg")};xm.add_message_div=function(msg,div_class){arguments.length==2?div_class=' class="'+div_class+'"':div_class="";var $msg_div=$("<div"+div_class+'><span class="dismiss js_dismiss"><a href="">X</a></span>'+msg+"</div>");$("#xm_ajax_errors").append($msg_div);$msg_div.slideDown(xm.animate_ajax_body_margin).find(".js_dismiss").on("click",function(e){e.preventDefault();$(this).parent().parent().slideUp(function(){$(this).remove();xm.animate_ajax_body_margin()})})};xm.hide_ajax_validation_msgs=function(){$("#xm_ajax_errors div.xm_ajax_validation_msg").slideUp(function(){$(this).remove()})};xm.animate_ajax_body_margin=function(){$("body").animate({marginTop:$("#xm_ajax_errors").height()+"px"},"fast","linear")};xm.add_default_ajax_error=function(return_data,default_msg){if(arguments.length===0){return_data=null;default_msg=xm.ajax_error_msgs.default_msg}else arguments.length==1&&(default_msg=xm.ajax_error_msgs.default_msg);return_data!==null&&typeof return_data=="object"&&typeof return_data.error_msg!="undefined"&&return_data.error_msg!==""?xm.add_ajax_error(return_data.error_msg):xm.add_ajax_error(default_msg)};$("#xm_ajax_errors").ajaxError(function(event,jqXHR,ajaxSettings,thrownError){if(typeof ajaxSettings.xm_ajax_error_display=="undefined"||ajaxSettings.xm_ajax_error_display){xm.add_ajax_error(xm.ajax_error_msgs.default_msg);xm_in_debug&&xm.ajax_log_msg("AJAX Error: "+thrownError)}});xm.process_ajax=function(return_data){if(typeof return_data!="object"||jQuery.isEmptyObject(return_data)){xm.add_default_ajax_error();xm_in_debug&&xm.ajax_log_msg("JSON data is not parsable");return!1}xm_in_debug&&typeof return_data.debug_msg!="undefined"&&return_data.debug_msg!==""&&xm.add_ajax_error(return_data.debug_msg);if(typeof return_data.status=="undefined"){xm_in_debug&&xm.ajax_log_msg("No status property in JSON data");return}switch(return_data.status){case 1:xm_in_debug&&xm.ajax_log_msg("AJAX all good");return!0;case 2:xm.add_default_ajax_error(return_data,xm.ajax_error_msgs.not_logged_in);xm_in_debug&&xm.ajax_log_msg("The user is not logged in");return!1;case 3:xm.add_default_ajax_error(return_data,xm.ajax_error_msgs.timed_out);xm_in_debug&&xm.ajax_log_msg("The user has timed out");return!1;case 4:xm.add_default_ajax_error(return_data,xm.ajax_error_msgs.not_allowed);xm_in_debug&&xm.ajax_log_msg("The user does not have permissions");return!1;case 5:xm.add_default_ajax_error(return_data,xm.ajax_error_msgs.not_found_404);xm_in_debug&&xm.ajax_log_msg("The page/path could not be found");return!1;case 6:xm.add_ajax_validation_msg(return_data);xm_in_debug&&xm.ajax_log_msg("There was a validation error");return!1;case 0:default:xm.add_default_ajax_error(return_data);xm_in_debug&&(typeof return_data.debug_msg!="undefined"&&return_data.debug_msg!==""?xm.ajax_log_msg("AJAX Error: "+return_data.debug_msg):xm.ajax_log_msg("An unknown error occurred"));return!1}};xm.ajax_log_msg=function(msg){try{console.log(msg)}catch(e){}};(function($){$.fn.numeric=function(){this.keypress(function(e){var key=e.charCode?e.charCode:e.keyCode?e.keyCode:0;return e.ctrlKey||e.altKey||key>=48&&key<=57||key==9||key==39||key==37||key==35||key==36||key==8||key==46||key==13||key==45||key==43?!0:!1})};$.fn.autofocus=function(){return Modernizr.input.autofocus?this:this.focus()};$.fn.check=function(){return this.each(function(){this.checked=!0})};$.fn.uncheck=function(){return this.each(function(){this.checked=!1})};$.fn.check_toggle=function(){return this.each(function(){this.checked=this.checked?!1:!0})};$.fn.checked=function(){return this.length>1?this.get(0).is(":checked"):this.length==1?this.is(":checked"):!1}})(jQuery);typeof $.datepicker!="undefined"&&$.datepicker.setDefaults({showOn:"both",buttonText:"Click to view the calendar and pick a date",showButtonPanel:!0,changeMonth:!0,changeYear:!0,constrainInput:!1,duration:"fast",yearRange:"c-5:c+5",appendText:"YYYY-MM-DD",onClose:function(dateText,inst){this.focus()}});$.ajaxSetup({cache:!1});$(function(){$("[autofocus]").autofocus();$(".numeric").numeric()});$(function(){$(".top_nav_wrapper").on("click","li.has_subnav > a",function(e){e.preventDefault();e.stopPropagation();var $link=$(this),$sub_nav=$link.parent().find(".sub_nav"),link_offset,link_width;if($sub_nav.css("visibility")!=="hidden"){$sub_nav.css({visibility:"hidden"});$link.removeClass("clicked")}else{$(".top_nav_wrapper li.has_subnav > a.clicked").click();link_offset=$link.offset();link_width=$link.width();$sub_nav.hasClass("right")?$sub_nav.css({right:$(window).width()-(link_offset.left+link_width+39),top:$link.parent().innerHeight(),visibility:"visible"}):$sub_nav.css({left:link_offset.left-5,top:$link.parent().innerHeight(),visibility:"visible"});$sub_nav.width()<link_width+19&&$sub_nav.css("width",link_width+19+"px");$link.addClass("clicked");$sub_nav.bind("clickoutside",function(){$(".top_nav_wrapper li.has_subnav > a.clicked").click()})}})});